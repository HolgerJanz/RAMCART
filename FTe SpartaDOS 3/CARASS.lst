mads 1.9.9
     1 				; Start Assembler Editor (8k, $1ff0)
     2
     3 				; OS equ
     4 = 022F			SDMCTL  = $022f
     5 = 03FA			GINTLK  = $3fa
     6 = 03EB			CARTCK  = $3eb
     7
     8 = D013			TRIG3   = $d013
     9 = D400			DMACTL  = $d400 
    10 = D40E			NMIEN   = $d40e
    11
    12 = E474			WARMST  = $e474
    13
    14 				; TC equ
    15 = D5A6			TCMOSL     = $d5a6    ; mode ($00-$3d,$01)
    16 = 0001			TCMOSL.8K  = $01      ; 8k banks at $A000
    17 = D5A7			TCMOFR     = $d5a7    ; flash/RAM mode (0-15,0)
    18
    19 = D5A0			TCPBRL = $d5a0    ; register low byte (0-255,0)
    20 = D5A1			TCPBRH = $d5a1    ; register high byte (0-63,0)
    21 = D5A2			TCPBEN = $d5a2    ; enable (0=dis-1=en,1)
    22
    23 = D5A3			TCSBRL = $d5a3    ; register low byte (0-255,0)
    24 = D5A4			TCSBRH = $d5a4    ; register high byte (0-63,0)
    25 = D5A5			TCSBEN = $d5a5    ; enable (0=dis-1=en,0)
    26
    27 				; Main
    28 				        org $2000
    29
    30 FFFF> 2000-2042> A9 00	        lda #$00        ; switch off DMA
    31 2002 8D 2F 02		        sta SDMCTL
    32 2005 8D 00 D4		        sta DMACTL
    33
    34 2008 78			        sei             ; mask all interrupts
    35 2009 A9 00		        lda #$00
    36 200B 8D 0E D4		        sta NMIEN
    37
    38 200E A9 F0		        lda #$f0
    39 2010 8D A0 D5		        sta TCPBRL
    40 2013 A9 1F		        lda #$1f        ; set P bank 
    41 2015 8D A1 D5		        sta TCPBRH
    42 				        
    43 2018 A9 00		        lda #$00
    44 201A 8D A3 D5		        sta TCSBRL      ; set S bank 
    45 201D 8D A4 D5		        sta TCSBRH
    46 2020 8D A5 D5		        sta TCSBEN      ; disable S
    47
    48 2023 8D A7 D5		        sta TCMOFR      ; cfg flash r/o
    49 2026 A9 01		        lda #TCMOSL.8K  ; set mode 8k
    50 2028 8D A6 D5		        sta TCMOSL
    51
    52 202B A9 01		        lda #$01        ; set cartridge flag
    53 202D 8D 13 D0		        sta TRIG3
    54 2030 8D FA 03		        sta GINTLK
    55 				        
    56 2033 A9 00		        lda #$00        ; set cart check sum
    57 2035 AA			        tax
    58 2036 18			        clc
    59 2037 7D F0 BF		_ccloop adc $bff0,x
    60 203A E8			        inx
    61 203B D0 FA		        bne _ccloop
    62 203D 8D EB 03		        sta CARTCK
    63
    64 2040 4C 74 E4		        jmp WARMST       ; warm start
    65 				        
